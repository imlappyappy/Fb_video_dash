{
  "pluginType": "DB",
  "pluginId": "postgres-plugin",
  "unpublishedAction": {
    "name": "Channel_New_Videos",
    "datasource": {
      "pluginId": "postgres-plugin",
      "messages": [],
      "isAutoGenerated": false,
      "id": "Fb_video_dashboard_datasrc",
      "deleted": false,
      "policies": [],
      "userPermissions": []
    },
    "pageId": "Facebook",
    "actionConfiguration": {
      "timeoutInMillisecond": 10000,
      "paginationType": "NONE",
      "encodeParamsToggle": true,
      "body": "with CTE_sumtotal as (\n\tSELECT (case EXTRACT(month FROM date_trunc('month',view_date)) when '1' THEN 'Jan'\n\t\t\t\twhen '2' THEN 'Feb'\n\t\t\t\twhen '3' THEN 'Mar'\n\t\t\t\twhen '4' THEN 'Apr'\n\t\t\t\twhen '5' THEN 'May'\n\t\t\t\twhen '6' THEN 'June'\n\t\t\t\twhen '7' THEN 'July'\n\t\t\t\twhen '8' THEN 'Aug'\n\t\t\t\twhen '9' THEN 'Sept'\n\t\t\t\twhen '10' THEN 'Oct'\n\t\t\t\twhen '11' THEN 'Nov'\n\t\t\t\twhen '12' THEN 'Dec'\n\t\t\t\tEND) as Month,\n\tvideo_id,name,\n\tcount(DISTINCT(video_id)) as count_site,\n\tsum(total_video_views::decimal) as total_video_views,\n\tsum(total_video_view_total_time::decimal) as Total_Watch_Hrs,\n\tSUM(total_video_impressions::decimal)/1000 as Revenue\n\tFROM public.smg_dmp_fb_video_dashboard_unq_view \n\tWHERE view_date = '{{End_date.selectedDate}}':: date\n\t\t\tAND name like {{Domain_select.selectedOptionValue ? Domain_select.selectedOptionValue : \"%\"}}\nand created_time >= '{{Start_date.selectedDate}}'\n  AND created_time <= '{{End_date.selectedDate}}'\n\tand name is not null\ngroup by 1,2,3),\nCTE_view_date as (\n\tSELECT (case EXTRACT(month FROM date_trunc('month',view_date)) when '1' THEN 'Jan'\n\t\t\t\twhen '2' THEN 'Feb'\n\t\t\t\twhen '3' THEN 'Mar'\n\t\t\t\twhen '4' THEN 'Apr'\n\t\t\t\twhen '5' THEN 'May'\n\t\t\t\twhen '6' THEN 'June'\n\t\t\t\twhen '7' THEN 'July'\n\t\t\t\twhen '8' THEN 'Aug'\n\t\t\t\twhen '9' THEN 'Sept'\n\t\t\t\twhen '10' THEN 'Oct'\n\t\t\t\twhen '11' THEN 'Nov'\n\t\t\t\twhen '12' THEN 'Dec'\n\t\t\t\tEND) as Month,\n\tvideo_id,name,\n\tcount(DISTINCT(video_id)) as count_site,\n\tsum(total_video_views::decimal) as total_video_views,\n\tsum(total_video_view_total_time::decimal) as Total_Watch_Hrs,\n\tSUM(total_video_impressions::decimal)/1000 as Revenue\n\tFROM public.smg_dmp_fb_video_dashboard_unq_view \n\tWHERE view_date = '{{Start_date.selectedDate}}':: date\n\t\t\tAND name like {{Domain_select.selectedOptionValue ? Domain_select.selectedOptionValue : \"%\"}}\nand created_time >= '{{Start_date.selectedDate}}'\n  AND created_time <= '{{End_date.selectedDate}}'\n\tand name is not null\ngroup by 1,2,3)\nSELECT * FROM(\nselect coalesce(CTE_sumtotal.name,CTE_view_date.name) as channel,\nCTE_sumtotal.month as Months,\nSUM(CTE_sumtotal.count_site) as cnt,\nSUM(coalesce(CTE_sumtotal.Total_Video_Views,0)-coalesce(CTE_view_date.Total_Video_Views,0)) as Views,\nSUM(coalesce(CTE_sumtotal.Total_Watch_Hrs,0)-coalesce(CTE_view_date.Total_Watch_Hrs,0)) as Watch_Hrs,\nSUM(coalesce(CTE_sumtotal.Revenue,0)-coalesce(CTE_view_date.Revenue,0)) as Revenue\nfrom CTE_sumtotal \nFULL outer join CTE_view_date on CTE_sumtotal.video_id=CTE_view_date.video_id\nwhere coalesce(CTE_sumtotal.name,CTE_view_date.name) is not null \nand CTE_sumtotal.month is not null\ngroup by 1,2\norder by 1)\nAS Total\nUNION ALL\nselect * from (\n\tselect 'Total','Month',\n\tsum(CTE_sumtotal.count_site),\n\tSUM(coalesce(CTE_sumtotal.Total_Video_Views,0)-coalesce(CTE_view_date.Total_Video_Views,0)),\n\tSUM(coalesce(CTE_sumtotal.Total_Watch_Hrs,0)-coalesce(CTE_view_date.Total_Watch_Hrs,0)),\n\tSUM(coalesce(CTE_sumtotal.Revenue,0)-coalesce(CTE_view_date.Revenue,0))\n\tfrom CTE_sumtotal FULL outer join CTE_view_date on CTE_sumtotal.video_id=CTE_view_date.video_id)\nas main;"
    },
    "executeOnLoad": true,
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "isValid": true,
    "invalids": [],
    "messages": [],
    "jsonPathKeys": [
      "Domain_select.selectedOptionValue ? Domain_select.selectedOptionValue : \"%\"",
      "End_date.selectedDate",
      "Start_date.selectedDate"
    ],
    "userSetOnLoad": false,
    "confirmBeforeExecute": false,
    "policies": [],
    "userPermissions": []
  },
  "id": "Facebook_Channel_New_Videos",
  "deleted": false,
  "gitSyncId": "62837f843cd70e097b62341a_62b99a684c1f4b56d4d33d8a"
}